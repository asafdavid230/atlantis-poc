version: 3
projects:
# If two or more projects have the same dir and workspace, they must also have
# a 'name' key to differentiate them.
- name: ec2-development
  dir: ec2
  workflow: development
  workspace: development-us-east-1
  autoplan:
    when_modified: ["*.tf"]
    enabled: true
  apply_requirements: [approved]
- name: ec2-production
  dir: ec2
  workflow: production
  workspace: production-us-east-1
  autoplan:
    when_modified: ["*.tf"]
    enabled: false
  apply_requirements: [approved, mergeable]
workflows:
  development:
      plan:
        steps:
          - init
          - plan:
              extra_args: ["-var-file", "tfvars/development-us-east-1-terraform.tfvars"]
  production:
    plan:
      steps:
        - init
        - plan:
            extra_args: ["-var-file", "tfvars/production-us-east-1-terraform.tfvars"]